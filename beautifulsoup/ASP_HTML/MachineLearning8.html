<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Python Machine Learning Polynomial Regression</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Polynomial Regression</h1>

<hr/>
<h2>Polynomial Regression</h2>
<p>If your data points clearly will not fit a linear regression (a straight line 
through all data points), it might be ideal for polynomial regression.</p>
<p>Polynomial regression, like linear regression, uses the relationship between the 
variables x and y to find the best way to draw a line through the data points.</p>
<img src="img_polynomial_regression.png" style="max-width:100%"/>
<hr/>
<h2>How Does it Work?</h2>
<p>Python has methods for finding a relationship between data-points and to draw 
a line of polynomial regression. We will show you how to use these methods 
instead of going through the mathematic formula.</p>
<p>In the example below, we have registered 18 cars as they were passing a 
certain tollbooth.</p>
<p>We have registered the car's speed, and the time of day (hour) the passing 
occurred.</p>
<p>The x-axis represents the hours of the day and the y-axis represents the 
speed:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Start by drawing a scatter plot:</p>
<div class="w3-code notranslate pythonHigh">
  import matplotlib.pyplot as plt<br/><br/>x = [1,2,3,5,6,7,8,9,10,12,13,14,15,16,18,19,21,22]<br/>y = [100,90,80,60,60,55,60,65,70,70,75,76,78,79,90,99,99,100]<br/><br/>
  plt.scatter(x, y)<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_polynomial_scatter.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_polynomial_scatterplot" target="_blank">Run example »</a>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>Import <code class="w3-codespan">numpy</code> and <code class="w3-codespan">
  matplotlib</code> then draw the line of 
  Polynomial Regression:</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>import matplotlib.pyplot as plt<br/><br/>x = [1,2,3,5,6,7,8,9,10,12,13,14,15,16,18,19,21,22]<br/>y = 
  [100,90,80,60,60,55,60,65,70,70,75,76,78,79,90,99,99,100]<br/><br/>mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))<br/><br/>myline = numpy.linspace(1, 22, 100)<br/><br/>plt.scatter(x, y)<br/>plt.plot(myline, mymodel(myline))<br/>
  plt.show()</div>
<h3>Result:</h3>
<p><img src="img_polynomial_regression.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_polynomial_regr" target="_blank">Run example »</a>
</div>
<h3>Example Explained</h3>
<p>Import the modules you need.</p>
<p>You can learn about the NumPy module in our <a href="numpy/default.asp">NumPy Tutorial</a>.</p>
<p>You can learn about the SciPy module in our <a href="scipy_intro.asp">SciPy Tutorial</a>.</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">import numpy<br/>import matplotlib.pyplot as plt</code></p>
</div>
<p>Create the arrays that represent the values of the x and y axis:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  x = [1,2,3,5,6,7,8,9,10,12,13,14,15,16,18,19,21,22]<br/>y = 
  [100,90,80,60,60,55,60,65,70,70,75,76,78,79,90,99,99,100]
</code></p>
</div>
<p>NumPy has a method that lets us make a polynomial model:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))</code></p>
</div>
<p>Then specify how the line will display, we start at position 1, and end at 
position 22:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  myline = numpy.linspace(1, 22, 100)</code></p>
</div>
<p>Draw the original scatter plot:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
plt.scatter(x, y)</code></p>
</div>
<p>Draw the line of polynomial regression:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  plt.plot(myline, mymodel(myline))</code></p>
</div>
<p>Display the diagram:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  plt.show()</code></p>
</div>
<hr/>

<hr/>
<h2>R-Squared</h2>
<p>It is important to know how well the relationship between the values of the 
x- and y-axis is, if there are no relationship the 
polynomial 
regression can not be used to predict anything.</p>
<p>The relationship is measured with a value called the r-squared.</p>
<p>The r-squared value ranges from 0 to 1, where 0 means no relationship, and 1 
means 100% related.</p>
<p>Python and the Sklearn module will compute this value for you, all you have to 
do is feed it with the x and y arrays:</p>
<div class="w3-example">
<h3>Example</h3>
<p>How well does my data fit in a polynomial regression?</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from sklearn.metrics import r2_score<br/><br/>x = 
  [1,2,3,5,6,7,8,9,10,12,13,14,15,16,18,19,21,22]<br/>y = 
  [100,90,80,60,60,55,60,65,70,70,75,76,78,79,90,99,99,100]<br/><br/>mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))<br/><br/>print(r2_score(y, mymodel(x)))</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_polynomial_r" target="_blank">Try if Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p><strong>Note:</strong>  The result 0.94 shows that there is a very good relationship, 
  and we can use polynomial regression in future 
  predictions.</p>
</div>
<hr/>
<h2>Predict Future Values</h2>
<p>Now we can use the information we have gathered to predict future values.</p>
<p>Example: Let us try to predict the speed of a car that passes the tollbooth 
at around 17 P.M:</p>
<p>To do so, we need the same <code class="w3-codespan">mymodel</code> array 
from the example above:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  mymodel = numpy.poly1d(numpy.polyfit(x, y, 3))</code></p>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>Predict the speed of a car passing at 17 P.M:</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from sklearn.metrics import r2_score<br/><br/>x = 
  [1,2,3,5,6,7,8,9,10,12,13,14,15,16,18,19,21,22]<br/>y = 
  [100,90,80,60,60,55,60,65,70,70,75,76,78,79,90,99,99,100]<br/><br/>mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))<br/><br/>speed = mymodel(17)<br/>print(speed)</div>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_polynomial_predict" target="_blank">Run example »</a>
</div>
<p>The example predicted a speed to be 88.87, which we also could read from the diagram:</p>
<img src="img_polynomial_prediction.png" style="max-width:100%"/>
<hr/>
<h2>Bad Fit?</h2>
<p>Let us create an example where polynomial regression would not be the best method 
to predict future values.</p>
<div class="w3-example">
<h3>Example</h3>
<p>These values for the x- and y-axis should result in a very bad fit for 
  polynomial 
  regression:</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>import matplotlib.pyplot as plt<br/><br/>x = 
  [89,43,36,36,95,10,66,34,38,20,26,29,48,64,6,5,36,66,72,40]<br/>y = 
  [21,46,3,35,67,95,53,72,58,10,26,34,90,33,38,20,56,2,47,15]<br/><br/>mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))<br/><br/>myline = numpy.linspace(2, 95, 100)<br/>
<br/>plt.scatter(x, y)<br/>plt.plot(myline, mymodel(myline))<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_polynomial_badfit.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_polynomial_badfit" target="_blank">Run example »</a>
</div>
<p>And the r-squared value?</p>
<div class="w3-example">
<h3>Example</h3>
<p>You should get a very low r-squared value.</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from sklearn.metrics import r2_score<br/><br/>x = 
  [89,43,36,36,95,10,66,34,38,20,26,29,48,64,6,5,36,66,72,40]<br/>y = 
  [21,46,3,35,67,95,53,72,58,10,26,34,90,33,38,20,56,2,47,15]<br/><br/>mymodel = 
  numpy.poly1d(numpy.polyfit(x, y, 3))<br/><br/>print(r2_score(y, mymodel(x)))<br/>
</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_polynomial_badfit_r" target="_blank">Try if Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p>The result: 0.00995 indicates a very bad relationship, and tells us that this data set is not suitable for polynomial regression.</p>
</div>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>