<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Python Machine Learning Train/Test</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Train/Test</h1>

<hr/>
<h2>Evaluate Your Model</h2>
<p>In Machine Learning we create models to predict the outcome of certain events,
like in the previous chapter where we predicted the CO2 emission of a car when we knew
the weight and engine size.</p>
<p>To measure if the model is good enough, we can use a method called Train/Test.</p>
<hr/>
<h2>What is Train/Test</h2>
<p>Train/Test is a method to measure the accuracy of your model.</p>
<p>It is called Train/Test because you split the the data set into two sets: a training set and a testing set.</p>
<div class="w3-panel w3-note">
<p> 
  80% for training, and 20% for testing.</p>
</div>
<p>You <em>train</em> the model using the training set.</p>
<p>You <em>test</em> the model using the testing set.</p>
<div class="w3-panel w3-note">
<p><em>Train</em> the model means <em>create</em> the model.</p>
<p><em>Test</em> the model means test the accuracy of the model.</p>
</div>
<hr/>
<h2>Start With a Data Set</h2>
<p>Start with a data set you want to test.</p>
<p>Our data set illustrates 100 customers in a shop, and their shopping habits.</p>
<div class="w3-example">
<h3>Example</h3>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>import matplotlib.pyplot as plt<br/>numpy.random.seed(2)<br/>
<br/>x = numpy.random.normal(3, 1, 100)<br/>y = numpy.random.normal(150, 40, 
  100) / x<br/><br/>plt.scatter(x, y)<br/>plt.show()</div>
<h3>Result:</h3>
<p>The x axis represents the number of minutes before making a purchase.</p>
<p>The y axis represents the amount of money spent on the purchase.</p>
<p><img src="img_traintest1.png" style="max-width:100%"/></p>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_traintest1" target="_blank">Run example »</a>
</p>
</div>
<hr/>

<hr/>
<h2>Split Into Train/Test</h2>
<p>The <em>training</em> set should be a random selection of 80% of the original data.</p>
<p>The <em>testing</em> set should be the remaining 20%.</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">train_x = x[:80]<br/>
train_y = y[:80]<br/>
<br/>
test_x = x[80:]<br/>
test_y = y[80:]</code></p>
</div>
<hr/>
<h2>Display the Training Set</h2>
<p>Display the same scatter plot with the training set:</p>
<div class="w3-example">
<h3>Example</h3>
<div class="w3-code notranslate pythonHigh">
  plt.scatter(train_x, 
  train_y)<br/>plt.show()</div>
<h3>Result:</h3>
<p>It looks like the original data set, so it seems to be a fair 
selection:</p>
<p><img src="img_traintest2.png" style="max-width:100%"/></p>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_traintest2" target="_blank">Run example »</a>
</p>
</div>
<hr/>
<h2>Display the Testing Set</h2>
<p>To make sure the testing set is not completely different, we will take a look at the testing set as well.</p>
<div class="w3-example">
<h3>Example</h3>
<div class="w3-code notranslate pythonHigh">
  plt.scatter(test_x, 
  test_y)<br/>plt.show()</div>
<h3>Result:</h3>
<p>The testing set also looks like the original data set:</p>
<p><img src="img_traintest3.png" style="max-width:100%"/></p>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_traintest3" target="_blank">Run example »</a>
</p>
</div>
<hr/>
<h2>Fit the Data Set</h2>
<p>What does the data set look like? In my opinion I think the best fit would be 
a <a href="python_ml_polynomial_regression.asp">polynomial regression</a>, so let us draw a line of polynomial regression.</p>
<p>To draw a line through the data points, we use the <code class="w3-codespan">
plot()</code> method of the matplotlib module:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Draw a polynomial regression line through the data points:</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>import 
  matplotlib.pyplot as plt<br/>numpy.random.seed(2)<br/><br/>x = 
  numpy.random.normal(3, 1, 100)<br/>y = numpy.random.normal(150, 40, 100) / x<br/>
<br/>train_x = x[:80]<br/>train_y = y[:80]<br/><br/>test_x = x[80:]<br/>test_y = 
  y[80:]<br/><br/>mymodel = numpy.poly1d(numpy.polyfit(train_x, train_y, 4))<br/>
<br/>myline = numpy.linspace(0, 6, 100)<br/><br/>plt.scatter(train_x, train_y)<br/>
  plt.plot(myline, mymodel(myline))<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_traintest3_2.png" style="max-width:100%"/></p>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_traintest3_2" target="_blank">Run example »</a>
</p>
</div>
<p>The result can back my suggestion of the data set fitting a polynomial 
regression, even though it would give us some weird results if we try to predict 
values outside of the data set. Example: the line indicates that a customer 
spending 6 minutes in the shop would make a purchase worth 200. That is probably 
a sign of overfitting.</p>
<p>But what about the R-squared score? The R-squared score is a good indicator 
of how well my data set is fitting the model.</p>
<hr/>
<h2>R2</h2>
<p>Remember R2, also known as R-squared?</p>
<p>It measures the relationship between the x axis and the y 
axis, and the value ranges from 0 to 1, where 0 means no relationship, and 1 
means totally related.</p>
<p>The sklearn module has a method called <code class="w3-codespan">r2_score()</code> 
that will help us find this relationship.</p>
<p>In this case we would like to measure the relationship  
between the minutes a customer stays in the shop and how much money they spend.</p>
<div class="w3-example">
<h3>Example</h3>
<p>How well does my training data fit in a polynomial regression?</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from sklearn.metrics import r2_score<br/>numpy.random.seed(2)<br/>
<br/>x = numpy.random.normal(3, 1, 100)<br/>y = numpy.random.normal(150, 40, 
  100) / x<br/><br/>train_x = x[:80]<br/>train_y = y[:80]<br/><br/>test_x = x[80:]<br/>
  test_y = y[80:]<br/><br/>mymodel = numpy.poly1d(numpy.polyfit(train_x, train_y, 
  4))<br/><br/>r2 = r2_score(train_y, mymodel(train_x))<br/><br/>print(r2)</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_traintest4" target="_blank">Try it Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p><strong>Note:</strong>  The result 0.799 shows that there is a OK relationship.</p>
</div>
<h2>Bring in the Testing Set</h2>
<p>Now we have made a model that is OK, at least when it comes to training data.</p>
<p>Now we want to test the model with the testing data as well, to see if gives us the 
same result.</p>
<div class="w3-example">
<h3>Example</h3>
<p>Let us find the R2 score when using testing data:</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from sklearn.metrics import r2_score<br/>numpy.random.seed(2)<br/>
<br/>x = numpy.random.normal(3, 1, 100)<br/>y = numpy.random.normal(150, 40, 
  100) / x<br/><br/>train_x = x[:80]<br/>train_y = y[:80]<br/><br/>test_x = x[80:]<br/>
  test_y = y[80:]<br/><br/>mymodel = numpy.poly1d(numpy.polyfit(train_x, train_y, 
  4))<br/><br/>r2 = r2_score(test_y, mymodel(test_x))<br/><br/>print(r2)</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_traintest5" target="_blank">Try it Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p><strong>Note:</strong>  The result 0.809 shows that the model fits the 
  testing set as well, and we are confident that we can use the model to predict 
  future values.</p>
</div>
<hr/>
<h2>Predict Values</h2>
<p>Now that we have established that our model is OK, we can start predicting 
new values.</p>
<div class="w3-example">
<h3>Example</h3>
<p>How much money will a buying customer spend, if she or he stays in the shop 
  for 5 minutes?</p>
<div class="w3-code notranslate pythonHigh">
  print(mymodel(5))</div>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_traintest6" target="_blank">Run example »</a>
</div>
<p>The example predicted the customer to spend 22.88 dollars, as seems to correspond to the diagram:</p>
<img src="img_traintest_predict.png" style="max-width:100%"/>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>