<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Python Machine Learning Linear Regression</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Linear Regression</h1>

<hr/>
<h2>Regression</h2>
<p>The term regression is used when you try to find the relationship between variables.</p>
<p>In Machine Learning, and in statistical modeling, that relationship is used to predict the outcome of future events.</p>
<hr/>
<h2>Linear Regression</h2>
<p>Linear regression uses the relationship between the data-points to draw a straight line through 
all them.</p>
<p>This line can be used to predict future values.</p>
<img src="img_linear_regression.png" style="max-width:100%"/>
<p>In Machine Learning, predicting the future is very important.</p>
<hr/>
<h2>How Does it Work?</h2>
<p>Python has methods for finding a relationship between data-points and to draw a line of linear regression. 
We will show you 
how to use these methods instead of going through the mathematic formula.</p>
<p>In the example below, the x-axis represents age, and the y-axis represents speed. We have registered the age and speed of 13 cars as they were passing a 
tollbooth. Let us see if the data we collected could be used in a linear 
regression:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Start by drawing a scatter plot:</p>
<div class="w3-code notranslate pythonHigh">
  import matplotlib.pyplot as plt<br/><br/>x = [5,7,8,7,2,17,2,9,4,11,12,9,6]<br/>y = 
  [99,86,87,88,111,86,103,87,94,78,77,85,86]<br/><br/>plt.scatter(x, y)<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_matplotlib_scatter.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_scatterplot" target="_blank">Run example »</a>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>Import <code class="w3-codespan">scipy</code> and draw the line of Linear Regression:</p>
<div class="w3-code notranslate pythonHigh">
  import matplotlib.pyplot as plt<br/>from scipy import stats<br/>
<br/>x = [5,7,8,7,2,17,2,9,4,11,12,9,6]<br/>y = 
  [99,86,87,88,111,86,103,87,94,78,77,85,86]<br/><br/>slope, intercept, r, 
  p, std_err = stats.linregress(x, y)<br/><br/>def myfunc(x):<br/>  
  return slope * x + intercept<br/><br/>mymodel = list(map(myfunc, x))<br/><br/>
  plt.scatter(x, y)<br/>plt.plot(x, mymodel)<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_linear_regression.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_linear_regression" target="_blank">Run example »</a>
</div>
<h3>Example Explained</h3>
<p>Import the modules you need.</p>
<p>You can learn about the Matplotlib module in our <a href="matplotlib_intro.asp">Matplotlib Tutorial</a>.</p>
<p>You can learn about the SciPy module in our <a href="scipy_intro.asp">SciPy Tutorial</a>.</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">import matplotlib.pyplot as plt<br/>from scipy 
  import stats</code></p>
</div>
<p>Create the arrays that represent the values of the x and y axis:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
x = [5,7,8,7,2,17,2,9,4,11,12,9,6]<br/>y = [99,86,87,88,111,86,103,87,94,78,77,85,86]
</code></p>
</div>
<p>Execute a method that returns some important key values of Linear Regression:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
slope, intercept, r, 
  p, std_err = stats.linregress(x, y)</code></p>
</div>
<p>Create a function that uses the <code class="w3-codespan">slope</code> and 
<code class="w3-codespan">intercept</code> values to return a new value. This 
new value represents where on the y-axis the corresponding x value will be 
placed:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
def myfunc(x):<br/>
  return slope * x + intercept</code></p>
</div>
<p>Run each value of the x array through the function. This will result in a new 
array with new values for the y-axis:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  mymodel = list(map(myfunc, x))</code></p>
</div>
<p>Draw the original scatter plot:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
plt.scatter(x, y)</code></p>
</div>
<p>Draw the line of linear regression:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  plt.plot(x, mymodel)</code></p>
</div>
<p>Display the diagram:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
  plt.show()</code></p>
</div>
<hr/>

<hr/>
<h2>R for Relationship</h2>
<p>It is important to know how the relationship between the values of the 
x-axis and the values of the y-axis is, if there are no relationship the linear 
regression can not be used to predict anything.</p>
<p>This relationship - the coefficient of correlation - is called
<code class="w3-codespan">r</code>.</p>
<!--<p>The relationship is measured with a value called the r-squared.</p>-->
<p>The <code class="w3-codespan">r</code> value ranges from -1 to 1, where 0 means no relationship, and 1 
(and -1) 
means 100% related.</p>
<p>Python and the Scipy module will compute this value for you, all you have to 
do is feed it with the x and y values.</p>
<div class="w3-example">
<h3>Example</h3>
<p>How well does my data fit in a linear regression?</p>
<div class="w3-code notranslate pythonHigh">
  from scipy import stats<br/><br/>x = 
  [5,7,8,7,2,17,2,9,4,11,12,9,6]<br/>y = 
  [99,86,87,88,111,86,103,87,94,78,77,85,86]<br/><br/>slope, intercept, r, 
  p, std_err = stats.linregress(x, y)<br/><br/>print(r)<br/>
</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_r_squared" target="_blank">Try it Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p><strong>Note:</strong> The result -0.76 shows that there is a relationship, 
  not perfect, but it indicates that we could use linear regression in future 
  predictions.</p>
</div>
<hr/>
<h2>Predict Future Values</h2>
<p>Now we can use the information we have gathered to predict future values.</p>
<p>Example: Let us try to predict the speed of a 10 years old car.</p>
<p>To do so, we need the same <code class="w3-codespan">myfunc()</code> function 
from the example above:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">
def myfunc(x):<br/>
  return slope * x + intercept</code></p>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>Predict the speed of a 10 years old car:</p>
<div class="w3-code notranslate pythonHigh">
  from scipy import stats<br/>
<br/>x = [5,7,8,7,2,17,2,9,4,11,12,9,6]<br/>y = 
  [99,86,87,88,111,86,103,87,94,78,77,85,86]<br/><br/>slope, intercept, r, 
  p, std_err = stats.linregress(x, y)<br/><br/>def myfunc(x):<br/>  
  return slope * x + intercept<br/><br/>speed = myfunc(10)<br/><br/>
  print(speed)</div>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_r_squared2" target="_blank">Run example »</a>
</div>
<p>The example predicted a speed at 85.6, which we also could read from the 
diagram:</p>
<img src="img_linear_regression2.png" style="max-width:100%"/>
<hr/>
<h2>Bad Fit?</h2>
<p>Let us create an example where linear regression would not be the best method 
to predict future values.</p>
<div class="w3-example">
<h3>Example</h3>
<p>These values for the x- and y-axis should result in a very bad fit for linear 
  regression:</p>
<div class="w3-code notranslate pythonHigh">
  import matplotlib.pyplot as plt<br/>from scipy import stats<br/>
<br/>x = [89,43,36,36,95,10,66,34,38,20,26,29,48,64,6,5,36,66,72,40]<br/>y = 
  [21,46,3,35,67,95,53,72,58,10,26,34,90,33,38,20,56,2,47,15]<br/><br/>slope, 
  intercept, r, p, std_err = stats.linregress(x, y)<br/><br/>def 
  myfunc(x):<br/>  return slope * x + intercept<br/><br/>mymodel = list(map(myfunc, 
  x))<br/><br/>plt.scatter(x, y)<br/>plt.plot(x, mymodel)<br/>plt.show()</div>
<h3>Result:</h3>
<p><img src="img_linear_regression_badfit.png" style="max-width:100%"/></p>
<a class="w3-btn w3-margin-bottom" href="showpython.asp?filename=demo_ml_bad_fit" target="_blank">Run example »</a>
</div>
<p>And the <code class="w3-codespan">r</code> for relationship?</p>
<div class="w3-example">
<h3>Example</h3>
<p>You should get a very low <code class="w3-codespan">r</code> value.</p>
<div class="w3-code notranslate pythonHigh">
  import numpy<br/>from scipy import stats<br/><br/>x = 
  [89,43,36,36,95,10,66,34,38,20,26,29,48,64,6,5,36,66,72,40]<br/>y = 
  [21,46,3,35,67,95,53,72,58,10,26,34,90,33,38,20,56,2,47,15]<br/><br/>slope, intercept, r, 
  p, std_err = stats.linregress(x, y)<br/><br/>print(r)<br/>
</div>
<a class="w3-btn w3-margin-bottom" href="trypython.asp?filename=demo_ml_r_squared_badfit" target="_blank">Try it Yourself »</a>
</div>
<div class="w3-panel w3-note">
<p>The result: 0.013 indicates a very bad relationship, and tells us that this data set is not suitable for linear regression.</p>
</div>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>