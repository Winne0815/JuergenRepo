<!DOCTYPE html>
<html lang="en-US">
<head>
<style>
.co2cars td:nth-child(1){text-align:left!important;width:20%;}
.co2cars td:nth-child(2){text-align:left!important;width:20%;}
.co2cars td:nth-child(3){text-align:right!important;width:20%;}
.co2cars td:nth-child(4){text-align:right!important;width:20%;}
.co2cars td:nth-child(5){text-align:right!important;width:20%;padding-right:20px;}
</style>
<title>Python Machine Learning Scaling</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Scale</h1>

<hr/>
<h2>Scale Features</h2>
<p>When your data has different values, and even different measurement units, it can be difficult to 
compare them. What is kilograms compared to meters? Or altitude compared to time?</p>
<p>The answer to this problem is scaling. We can scale data into new values that are easier to 
compare.</p>
<p>Take a look at the table below, it is the same data set that we used in the 
<a href="python_ml_multiple_regression.asp">multiple regression chapter</a>, but this time the <strong>volume</strong> column 
contains values in<em> liters</em> instead of <em>cm<sup>3</sup></em> (1.0 instead of 1000).</p>
<p>The file is meant for testing purposes only, you can download it here: <a href="cars2.csv">cars2.csv</a></p>
<div class="w3-border-bottom" style="margin-right:-20px;margin-left:-20px;">
<table class="ws-table-all co2cars" style="margin:0">
<thead>
<tr class="w3-light-grey">
<td>Car</td>
<td>Model</td>
<td>Volume</td>
<td>Weight</td>
<td>CO2</td>
<td style="width:10px"></td>
</tr>
</thead>
</table>
<div style="height:410px;overflow:auto;">
<table class="ws-table-all co2cars" style="margin:0;border-top:none;">
<tr>
<td>Toyota</td>
<td>Aygo</td>
<td>1.0</td>
<td>790</td>
<td>99</td>
</tr>
<tr>
<td>Mitsubishi</td>
<td>Space Star</td>
<td>1.2</td>
<td>1160</td>
<td>95</td>
</tr>
<tr>
<td>Skoda</td>
<td>Citigo</td>
<td>1.0</td>
<td>929</td>
<td>95</td>
</tr>
<tr>
<td>Fiat</td>
<td>500</td>
<td>0.9</td>
<td>865</td>
<td>90</td>
</tr>
<tr>
<td>Mini</td>
<td>Cooper</td>
<td>1.5</td>
<td>1140</td>
<td>105</td>
</tr>
<tr>
<td>VW</td>
<td>Up!</td>
<td>1.0</td>
<td>929</td>
<td>105</td>
</tr>
<tr>
<td>Skoda</td>
<td>Fabia</td>
<td>1.4</td>
<td>1109</td>
<td>90</td>
</tr>
<tr>
<td>Mercedes</td>
<td>A-Class</td>
<td>1.5</td>
<td>1365</td>
<td>92</td>
</tr>
<tr>
<td>Ford</td>
<td>Fiesta</td>
<td>1.5</td>
<td>1112</td>
<td>98</td>
</tr>
<tr>
<td>Audi</td>
<td>A1</td>
<td>1.6</td>
<td>1150</td>
<td>99</td>
</tr>
<tr>
<td>Hyundai</td>
<td>I20</td>
<td>1.1</td>
<td>980</td>
<td>99</td>
</tr>
<tr>
<td>Suzuki</td>
<td>Swift</td>
<td>1.3</td>
<td>990</td>
<td>101</td>
</tr>
<tr>
<td>Ford</td>
<td>Fiesta</td>
<td>1.0</td>
<td>1112</td>
<td>99</td>
</tr>
<tr>
<td>Honda</td>
<td>Civic</td>
<td>1.6</td>
<td>1252</td>
<td>94</td>
</tr>
<tr>
<td>Hundai</td>
<td>I30</td>
<td>1.6</td>
<td>1326</td>
<td>97</td>
</tr>
<tr>
<td>Opel</td>
<td>Astra</td>
<td>1.6</td>
<td>1330</td>
<td>97</td>
</tr>
<tr>
<td>BMW</td>
<td>1</td>
<td>1.6</td>
<td>1365</td>
<td>99</td>
</tr>
<tr>
<td>Mazda</td>
<td>3</td>
<td>2.2</td>
<td>1280</td>
<td>104</td>
</tr>
<tr>
<td>Skoda</td>
<td>Rapid</td>
<td>1.6</td>
<td>1119</td>
<td>104</td>
</tr>
<tr>
<td>Ford</td>
<td>Focus</td>
<td>2.0</td>
<td>1328</td>
<td>105</td>
</tr>
<tr>
<td>Ford</td>
<td>Mondeo</td>
<td>1.6</td>
<td>1584</td>
<td>94</td>
</tr>
<tr>
<td>Opel</td>
<td>Insignia</td>
<td>2.0</td>
<td>1428</td>
<td>99</td>
</tr>
<tr>
<td>Mercedes</td>
<td>C-Class</td>
<td>2.1</td>
<td>1365</td>
<td>99</td>
</tr>
<tr>
<td>Skoda</td>
<td>Octavia</td>
<td>1.6</td>
<td>1415</td>
<td>99</td>
</tr>
<tr>
<td>Volvo</td>
<td>S60</td>
<td>2.0</td>
<td>1415</td>
<td>99</td>
</tr>
<tr>
<td>Mercedes</td>
<td>CLA</td>
<td>1.5</td>
<td>1465</td>
<td>102</td>
</tr>
<tr>
<td>Audi</td>
<td>A4</td>
<td>2.0</td>
<td>1490</td>
<td>104</td>
</tr>
<tr>
<td>Audi</td>
<td>A6</td>
<td>2.0</td>
<td>1725</td>
<td>114</td>
</tr>
<tr>
<td>Volvo</td>
<td>V70</td>
<td>1.6</td>
<td>1523</td>
<td>109</td>
</tr>
<tr>
<td>BMW</td>
<td>5</td>
<td>2.0</td>
<td>1705</td>
<td>114</td>
</tr>
<tr>
<td>Mercedes</td>
<td>E-Class</td>
<td>2.1</td>
<td>1605</td>
<td>115</td>
</tr>
<tr>
<td>Volvo</td>
<td>XC70</td>
<td>2.0</td>
<td>1746</td>
<td>117</td>
</tr>
<tr>
<td>Ford</td>
<td>B-Max</td>
<td>1.6</td>
<td>1235</td>
<td>104</td>
</tr>
<tr>
<td>BMW</td>
<td>2</td>
<td>1.6</td>
<td>1390</td>
<td>108</td>
</tr>
<tr>
<td>Opel</td>
<td>Zafira</td>
<td>1.6</td>
<td>1405</td>
<td>109</td>
</tr>
<tr>
<td>Mercedes</td>
<td>SLK</td>
<td>2.5</td>
<td>1395</td>
<td>120</td>
</tr>
</table>
</div>
</div>
<p>It can be difficult to compare the volume 1.0 with the weight 790, but if we 
scale them both into comparable values, we can easily see how much one value 
is compared to the other.</p>
<p>There are different methods for scaling data, in this tutorial we will use a 
method called standardization.</p>
<p>The standardization method  
uses this formula:</p>
<p><code class="w3-codespan">z = (x - u) / s</code></p>
<p>Where <code class="w3-codespan">z</code> is the new value, 
<code class="w3-codespan">x</code> is the original value, 
<code class="w3-codespan">u</code> is the mean and <code class="w3-codespan">s</code> is the 
standard deviation.</p>
<p>If you take the <strong>weight</strong> column from the data set above, the first value 
is 790, and the scaled value will be:</p>
<code class="w3-codespan">(790 - <a href="showpython.asp?filename=demo_ml_scale_mean1" target="_blank">1292.23</a>) / <a href="showpython.asp?filename=demo_ml_scale_std1" target="_blank">238.74</a> = -2.1</code>
<p>If you take the <strong>volume</strong> column from the data set above, the first value 
is 1.0, and the scaled value 
will be:</p>
<p><code class="w3-codespan">(1.0 - <a href="showpython.asp?filename=demo_ml_scale_mean2" target="_blank">1.61</a>) / <a href="showpython.asp?filename=demo_ml_scale_std2" target="_blank">0.38</a> = -1.59</code></p>
<p>Now you can compare -2.1 with -1.59 instead of comparing 790 with 1.0.</p>
<p>You do not have to do this manually,
the Python sklearn module has a method called <code class="w3-codespan">StandardScaler()</code>
which returns a Scaler object with methods for transforming data sets.</p>
<div class="w3-example">
<h3>Example</h3>
<p>Scale all values in the Weight and Volume columns:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import linear_model<br/>from 
  sklearn.preprocessing import StandardScaler<br/>scale = StandardScaler()<br/>
<br/>df = pandas.read_csv("cars2.csv")<br/><br/>X = df[['Weight', 'Volume']]<br/>
<br/>scaledX = scale.fit_transform(X)<br/><br/>
  print(scaledX)</div>
<h3>Result:</h3>
<p>Note that the first two values are -2.1 and -1.59, which corresponds to our 
  calculations: </p>
<div class="w3-black w3-padding">
<pre>[[-2.10389253 -1.59336644]
 [-0.55407235 -1.07190106]
 [-1.52166278 -1.59336644]
 [-1.78973979 -1.85409913]
 [-0.63784641 -0.28970299]
 [-1.52166278 -1.59336644]
 [-0.76769621 -0.55043568]
 [ 0.3046118  -0.28970299]
 [-0.7551301  -0.28970299]
 [-0.59595938 -0.0289703 ]
 [-1.30803892 -1.33263375]
 [-1.26615189 -0.81116837]
 [-0.7551301  -1.59336644]
 [-0.16871166 -0.0289703 ]
 [ 0.14125238 -0.0289703 ]
 [ 0.15800719 -0.0289703 ]
 [ 0.3046118  -0.0289703 ]
 [-0.05142797  1.53542584]
 [-0.72580918 -0.0289703 ]
 [ 0.14962979  1.01396046]
 [ 1.2219378  -0.0289703 ]
 [ 0.5685001   1.01396046]
 [ 0.3046118   1.27469315]
 [ 0.51404696 -0.0289703 ]
 [ 0.51404696  1.01396046]
 [ 0.72348212 -0.28970299]
 [ 0.8281997   1.01396046]
 [ 1.81254495  1.01396046]
 [ 0.96642691 -0.0289703 ]
 [ 1.72877089  1.01396046]
 [ 1.30990057  1.27469315]
 [ 1.90050772  1.01396046]
 [-0.23991961 -0.0289703 ]
 [ 0.40932938 -0.0289703 ]
 [ 0.47215993 -0.0289703 ]
 [ 0.4302729   2.31762392]]</pre>
</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_scale1" target="_blank">Run example »</a>
</p>
</div>
<hr/>

<hr/>
<h2>Predict CO2 Values</h2>
<p>The task in the <a href="python_ml_multiple_regression.asp">Multiple Regression chapter</a> was to predict the CO2 emission from a car 
when you only knew its weight and volume.</p>
<p>When the data set is scaled, you will have to use the scale when you predict values:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Predict the CO2 emission from a 1.3 liter car that weighs 2300 kilograms:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import linear_model<br/>from 
  sklearn.preprocessing import StandardScaler<br/>scale = StandardScaler()<br/>
<br/>df = pandas.read_csv("cars2.csv")<br/><br/>X = df[['Weight', 'Volume']]<br/>
  y = df['CO2']<br/>
<br/>scaledX = scale.fit_transform(X)<br/><br/>
  regr = linear_model.LinearRegression()<br/>regr.fit(scaledX, y)<br/><br/>scaled = 
  scale.transform([[2300, 1.3]])<br/><br/>predictedCO2 = regr.predict([scaled[0]])<br/>
  print(predictedCO2)</div>
<h3>Result:</h3>
<div class="w3-black w3-padding">
<pre>[107.2087328]</pre>
</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_scale_predict" target="_blank">Run example »</a>
</p>
</div>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>