<!DOCTYPE html>
<html lang="en-US">
<head>
<style>
.co2cars td:nth-child(1){text-align:right!important;width:10%;}
.co2cars td:nth-child(2){text-align:center!important;width:25%;}
.co2cars td:nth-child(3){text-align:right!important;width:10%;}
.co2cars td:nth-child(4){text-align:right!important;width:15%;}
.co2cars td:nth-child(5){text-align:right!important;width:15%;}
.co2cars td:nth-child(6){text-align:center!important;}
</style>
<title>Python Machine Learning Decision Tree</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Decision Tree</h1>

<hr/>
<p style="text-align:center"><img src="img_ml_decision_tree.png" style="max-width:100%;"/></p>
<hr/>
<h2>Decision Tree</h2>
<p>In this chapter we will show you how to make a "Decision Tree". A Decision 
Tree is a Flow Chart, and can help you make decisions based on previous experience.</p>
<p>In the example, a person will try to decide if he/she should go to a comedy show or 
not.</p>
<p>Luckily our example person has registered every time there was a comedy show 
in town, and registered some information about the comedian, and also 
registered if he/she went or not.</p>
<table class="ws-table-all co2cars">
<tr>
<td>Age</td>
<td>Experience</td>
<td>Rank</td>
<td>Nationality</td>
<td>Go</td>
</tr><tr>
<td>36</td>
<td>10</td>
<td>9</td>
<td>UK</td>
<td>NO</td>
</tr>
<tr>
<td>42</td>
<td>12</td>
<td>4</td>
<td>USA</td>
<td>NO</td>
</tr>
<tr>
<td>23</td>
<td>4</td>
<td>6</td>
<td>N</td>
<td>NO</td>
</tr>
<tr>
<td>52</td>
<td>4</td>
<td>4</td>
<td>USA</td>
<td>NO</td>
</tr>
<tr>
<td>43</td>
<td>21</td>
<td>8</td>
<td>USA</td>
<td>YES</td>
</tr>
<tr>
<td>44</td>
<td>14</td>
<td>5</td>
<td>UK</td>
<td>NO</td>
</tr>
<tr>
<td>66</td>
<td>3</td>
<td>7</td>
<td>N</td>
<td>YES</td>
</tr>
<tr>
<td>35</td>
<td>14</td>
<td>9</td>
<td>UK</td>
<td>YES</td>
</tr>
<tr>
<td>52</td>
<td>13</td>
<td>7</td>
<td>N</td>
<td>YES</td>
</tr>
<tr>
<td>35</td>
<td>5</td>
<td>9</td>
<td>N</td>
<td>YES</td>
</tr>
<tr>
<td>24</td>
<td>3</td>
<td>5</td>
<td>USA</td>
<td>NO</td>
</tr>
<tr>
<td>18</td>
<td>3</td>
<td>7</td>
<td>UK</td>
<td>YES</td>
</tr>
<tr>
<td>45</td>
<td>9</td>
<td>9</td>
<td>UK</td>
<td>YES</td>
</tr>
</table>
<p>Now, based on this data set, Python can create a decision tree that can be used to decide 
if any new shows are worth attending to.</p>
<hr/>

<hr/>
<h2>How Does it Work?</h2>
<p>First, import the modules you need, and read the dataset with pandas:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Read and print the data set:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import tree<br/>import pydotplus<br/>from 
  sklearn.tree import DecisionTreeClassifier<br/>import matplotlib.pyplot as plt<br/>
  import matplotlib.image as pltimg<br/><br/>df = pandas.read_csv("shows.csv")<br/>
<br/>print(df)</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree1" target="_blank">Run example »</a>
</p>
</div>
<p>To make a decision tree, all data has to be numerical.</p>
<p>We have to convert the non numerical columns 'Nationality' and 'Go' into numerical values.</p>
<p>Pandas has a <code class="w3-codespan">map()</code> method that takes a dictionary with information on how to 
convert the values.</p>
<p><code class="w3-codespan">{'UK': 0, 'USA': 1, 'N': 2}</code></p>
<p>Means convert the values 'UK' to 0, 'USA' to 1, and 'N' to 2.</p>
<div class="w3-example">
<h3>Example</h3>
<p>Change string values into numerical values:</p>
<div class="w3-code notranslate pythonHigh">
  d = {'UK': 0, 
  'USA': 1, 'N': 2}<br/>df['Nationality'] = df['Nationality'].map(d)<br/>d = 
  {'YES': 1, 'NO': 0}<br/>df['Go'] = df['Go'].map(d)<br/><br/>print(df)</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree2" target="_blank">Run example »</a>
</p>
</div>
<p>Then we have to separate the <em>feature</em> columns from the <em>target</em> column.</p>
<p>The feature columns are the columns that we try to predict <em>from</em>, and 
the target column is the column with the values we try to predict.</p>
<div class="w3-example">
<h3>Example</h3>
<p><code class="w3-codespan">X</code> is the feature columns, 
<code class="w3-codespan">y</code> is the target column:</p>
<div class="w3-code notranslate pythonHigh">
  features = ['Age', 'Experience', 'Rank', 'Nationality']<br/><br/>X = df[features]<br/>y = df['Go']<br/><br/>
  print(X)<br/>print(y)</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree3" target="_blank">Run example »</a>
</p>
</div>
<p>Now we can create the actual decision tree, fit it with our details, and save 
a .png file on the computer:</p>
<div class="w3-example">
<h3>Example</h3>
<p>Create a Decision Tree, save it as an image, and show the image:</p>
<div class="w3-code notranslate pythonHigh">
  dtree = DecisionTreeClassifier()<br/>dtree = dtree.fit(X, y)<br/>data = 
  tree.export_graphviz(dtree, out_file=None, feature_names=features)<br/>graph = 
  pydotplus.graph_from_dot_data(data)<br/>graph.write_png('mydecisiontree.png')<br/>
<br/>img=pltimg.imread('mydecisiontree.png')<br/>imgplot = plt.imshow(img)<br/>
  plt.show()</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree4" target="_blank">Run example »</a>
</p>
</div>
<hr/>
<h2>Result Explained</h2>
<p>The decision tree uses your earlier decisions to calculate the odds for you to wanting to go see 
a comedian or not.</p>
<p>Let us read the different aspects of the decision tree:</p>
<p style="text-align:center"><img src="img_decisiontree1.png" style="max-width:100%;"/></p>
<h3>Rank</h3>
<p><code class="w3-codespan">Rank &lt;= 6.5</code> means that every comedian with a rank of 6.5 or 
lower will follow the 
<code class="w3-codespan">True</code> arrow (to the left), and the rest will 
follow the <code class="w3-codespan">False</code> arrow (to the right).</p>
<p><code class="w3-codespan">gini = 0.497</code> refers to the quality of the 
split, and is always a number between 0.0 and 0.5, where 0.0 would mean all of 
the samples got the same result, and 0.5 would mean that the split is done 
exactly in the middle.</p>
<p><code class="w3-codespan">samples = 13</code> means that there are 13 
comedians left at this point in the decision, which is all of them since this is 
the first step.</p>
<p><code class="w3-codespan">value = [6, 7]</code> means that of these 13 
comedians, 6 will get a "NO", and 7 will get a 
"GO".</p>
<div class="w3-panel w3-note">
<h3>Gini</h3>
<p>There are many ways to split the samples, we use the GINI method in this tutorial.</p>
<p>The Gini method uses this formula:</p>
<p><code class="w3-codespan">Gini = 1 - (x/n)<sup>2</sup> - (y/n)<sup>2</sup></code></p>
<p>Where <code class="w3-codespan">x</code> is the number of positive answers("GO"), 
<code class="w3-codespan">n</code> is the number of samples, and 
<code class="w3-codespan">y</code> is the number of negative answers ("NO"), 
which gives us this calculation:</p>
<p><code class="w3-codespan">1 - (7 / 13)<sup>2</sup> - (6 / 13)<sup>2</sup> = 0.497</code></p>
</div>
<p style="text-align:center"><img src="img_decisiontree2.png" style="max-width:100%;"/></p>
<p>The next step contains two boxes, one box for the comedians with a 'Rank' of 
6.5 or lower, and one box with the rest.</p>
<h3>True - 5 Comedians End Here:</h3>
<p><code class="w3-codespan">gini = 0.0</code> means all of the samples got the 
same result.</p>
<p><code class="w3-codespan">samples = 5</code> means that there are 5 comedians 
left in this branch (5 comedian with a Rank of 6.5 or lower).</p>
<p><code class="w3-codespan">value = [5, 0]</code> means that 5 will get a "NO" 
and 0 will get a "GO".</p>
<h3>False - 8 Comedians Continue:</h3>
<h3>Nationality</h3>
<p><code class="w3-codespan">Nationality &lt;= 0.5</code> means that the comedians 
with a nationality value of less than 0.5 will follow the arrow to the left 
(which means everyone from the UK, ), and the rest will follow the arrow to the 
right.</p>
<p><code class="w3-codespan">gini = 0.219</code> means that about 22% of the 
samples would go in one direction.</p>
<p><code class="w3-codespan">samples = 8</code> means that there are 8 comedians 
left in this branch (8 comedian with a Rank higher than 6.5).</p>
<p><code class="w3-codespan">value = [1, 7]</code> means that of these 8 
comedians, 1 will get a "NO" and 7 will get a "GO".</p>
<br/>
<hr/>
<br/>
<p style="text-align:center"><img src="img_decisiontree3_2.png" style="max-width:100%;"/></p>
<h3>True - 4 Comedians Continue:</h3>
<h3>Age</h3>
<p><code class="w3-codespan">Age &lt;= 35.5</code> means that comedians 
at the age of 35.5 or younger will follow the arrow to the left, and the rest will follow the arrow to the 
right.</p>
<p><code class="w3-codespan">gini = 0.375</code> means that about 37,5% of the 
samples would go in one direction.</p>
<p><code class="w3-codespan">samples = 4</code> means that there are 4 comedians 
left in this branch (4 comedians from the UK).</p>
<p><code class="w3-codespan">value = [1, 3]</code> means that of these 4 
comedians, 1 will get a "NO" and 3 will get a "GO".</p>
<h3>False - 4 Comedians End Here:</h3>
<p><code class="w3-codespan">gini = 0.0</code> means all of the samples got the 
same result.</p>
<p><code class="w3-codespan">samples = 4</code> means that there are 4 comedians 
left in this branch (4 comedians not from the UK).</p>
<p><code class="w3-codespan">value = [0, 4]</code> means that of these 4 
comedians, 0 will get a "NO" and 4 will get a "GO".</p>
<br/>
<hr/>
<br/>
<p style="text-align:center"><img src="img_decisiontree4_2.png" style="max-width:100%;"/></p>
<h3>True - 2 Comedians End Here:</h3>
<p><code class="w3-codespan">gini = 0.0</code> means all of the samples got the 
same result.</p>
<p><code class="w3-codespan">samples = 2</code> means that there are 2 comedians 
left in this branch (2 comedians at the age 35.5 or younger).</p>
<p><code class="w3-codespan">value = [0, 2]</code> means that of these 2 
comedians, 0 will get a "NO" and 2 will get a "GO".</p>
<h3>False - 2 Comedians Continue:</h3>
<h3>Experience</h3>
<p><code class="w3-codespan">Experience &lt;= 9.5</code> means that comedians 
with 9.5 years of experience, or less, will follow the arrow to the left, and the rest will follow the arrow to the 
right.</p>
<p><code class="w3-codespan">gini = 0.5</code> means that 50% of the samples 
would go in one direction.</p>
<p><code class="w3-codespan">samples = 2</code> means that there are 2 comedians 
left in this branch (2 comedians older than 35.5).</p>
<p><code class="w3-codespan">value = [1, 1]</code> means that of these 2 
comedians, 1 will get a "NO" and 1 will get a "GO".</p>
<br/>
<hr/>
<br/>
<p style="text-align:center"><img src="img_decisiontree5.png" style="max-width:100%;"/></p>
<h3>True - 1 Comedian Ends Here:</h3>
<p><code class="w3-codespan">gini = 0.0</code> means all of the samples got the 
same result.</p>
<p><code class="w3-codespan">samples = 1</code> means that there is 1 comedian 
left in this branch (1 comedian with 9.5 years of experience or less).</p>
<p><code class="w3-codespan">value = [0, 1]</code> means that 0 will get a "NO" and 
1 will get a "GO".</p>
<h3>False - 1 Comedian Ends Here:</h3>
<p><code class="w3-codespan">gini = 0.0</code> means all of the samples got the 
same result.</p>
<p><code class="w3-codespan">samples = 1</code> means that there is 1 comedians 
left in this branch (1 comedian with more than 9.5 years of experience).</p>
<p><code class="w3-codespan">value = [1, 0]</code> means that 1 will get a "NO" and 
0 will get a "GO".</p>
<hr/>
<h2>Predict Values</h2>
<p>We can use the Decision Tree to predict new values.</p>
<p>Example: Should I go see a show starring a 40 years old American comedian, with 10 years of experience, 
and a comedy ranking of 7?</p>
<div class="w3-example">
<h3>Example</h3>
<p>Use predict() method to predict new values:</p>
<div class="w3-code notranslate pythonHigh">
  print(dtree.predict([[40, 10, 7, 1]]))</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree_predict1" target="_blank">Run example »</a>
</p>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>What would the answer be if the comedy rank was 6?</p>
<div class="w3-code notranslate pythonHigh">
  print(dtree.predict([[40, 10, 6, 1]]))</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_dtree_predict2" target="_blank">Run example »</a>
</p>
</div>
<hr/>
<div class="w3-panel w3-note">
<h3>Different Results</h3>
<p>You will see that the Decision Tree gives you different results if you run 
  it enough times, even if you feed it with the same data.</p>
<p>That is because the Decision Tree does not give us a 100% certain answer. It is based on the 
  probability of an outcome, and the answer will vary.</p>
</div>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>