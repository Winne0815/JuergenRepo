<!DOCTYPE html>
<html lang="en-US">
<head>
<style>
.co2cars td:nth-child(1){text-align:left!important;width:20%;}
.co2cars td:nth-child(2){text-align:left!important;width:20%;}
.co2cars td:nth-child(3){text-align:right!important;width:20%;}
.co2cars td:nth-child(4){text-align:right!important;width:20%;}
.co2cars td:nth-child(5){text-align:right!important;width:20%;padding-right:20px;}
</style>
<title>Python Machine Learning Multiple Regression</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="HTML, Python, CSS, SQL, JavaScript, How to, PHP, Java, C++, jQuery, Bootstrap, C#, Colors, W3.CSS, XML, MySQL, Icons, NodeJS, React, Graphics, Angular, R, AI, Git, Data Science, Code Game, Tutorials, Programming, Web Development, Training, Learning, Quiz, Exercises, Courses, Lessons, References, Examples, Learn to code, Source code, Demos, Tips, Website" name="Keywords"/>
<meta content="Well organized and easy to understand Web building tutorials with lots of examples of how to use HTML, CSS, JavaScript, SQL, Python, PHP, Bootstrap, Java, XML and more." name="Description"/>
<meta content="https://www.w3schools.com/images/w3schools_logo_436_2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="436" property="og:image:width"/>
<meta content="228" property="og:image:height"/>
<meta content="W3Schools offers free online tutorials, references and exercises in all the major languages of the web. Covering popular subjects like HTML, CSS, JavaScript, Python, SQL, Java, and many, many more." property="og:description"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<link as="font" crossorigin="" href="/lib/fonts/fontawesome.woff2?14663396" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-code-pro-v14-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/roboto-mono-v13-latin-500.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/source-sans-pro-v14-latin-600.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/lib/fonts/freckle-face-v9-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link href="/lib/w3schools30.css" rel="stylesheet"/>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3855518-1', 'auto');
ga('require', 'displayfeatures');
ga('require', 'GTM-WJ88MZ5');
ga('send', 'pageview');
</script>
<script src="/lib/uic.js?v=1.0.3"></script>
<script data-cfasync="false" type="text/javascript">
var k42 = false;

k42 = true;

</script>
<script data-cfasync="false" type="text/javascript">
    window.snigelPubConf = {
    "adengine": {

      "activeAdUnits": ["main_leaderboard", "sidebar_top", "bottom_left", "bottom_right"]

  }
}
uic_r_a()
</script>
<script async="" data-cfasync="false" src="https://cdn.snigelweb.com/adengine/w3schools.com/loader.js" type="text/javascript"></script>
<script src="/lib/my-learning.js?v=1.0.7"></script>
<script type="text/javascript">
var stickyadstatus = "";
function fix_stickyad() {
  document.getElementById("stickypos").style.position = "sticky";
  var elem = document.getElementById("stickyadcontainer");
  if (!elem) {return false;}
  if (document.getElementById("skyscraper")) {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("skyscraper"), "width").replace("px", ""));  
    }
  else {
    var skyWidth = Number(w3_getStyleValue(document.getElementById("right"), "width").replace("px", ""));  
  }
  elem.style.width = skyWidth + "px";
  if (window.innerWidth <= 992) {
    elem.style.position = "";
    elem.style.top = stickypos + "px";
    return false;
  }
  var stickypos = document.getElementById("stickypos").offsetTop;
  var docTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
  var adHeight = Number(w3_getStyleValue(elem, "height").replace("px", ""));
  if (stickyadstatus == "") {
    if ((stickypos - docTop) < 60) {
      elem.style.position = "fixed";
      elem.style.top = "60px";
      stickyadstatus = "sticky";
      document.getElementById("stickypos").style.position = "sticky";

    }
  } else {
    if ((docTop + 60) - stickypos < 0) {  
      elem.style.position = "";
      elem.style.top = stickypos + "px";
      stickyadstatus = "";
      document.getElementById("stickypos").style.position = "static";
    }
  }
  if (stickyadstatus == "sticky") {
    if ((docTop + adHeight + 60) > document.getElementById("footer").offsetTop) {
      elem.style.position = "absolute";
      elem.style.top = (document.getElementById("footer").offsetTop - adHeight) + "px";
      document.getElementById("stickypos").style.position = "static";
    } else {
        elem.style.position = "fixed";
        elem.style.top = "60px";
        stickyadstatus = "sticky";
        document.getElementById("stickypos").style.position = "sticky";
    }
  }
}
function w3_getStyleValue(elmnt,style) {
  if (window.getComputedStyle) {
    return window.getComputedStyle(elmnt,null).getPropertyValue(style);
  } else {
    return elmnt.currentStyle[style];
  }
}
</script>
</head>
<body>
<style>
#darkmodemenu {
  position:absolute;
  top:-40px;
  right:16px;
  padding:5px 20px 10px 18px;
  border-bottom-left-radius:5px;
  border-bottom-right-radius:5px;
  z-index:-1;
  transition: top 0.2s;
  user-select: none;
}
#darkmodemenu input,#darkmodemenu label {
  cursor:pointer;
}
</style>
<script>
(
function setThemeMode() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.body.className += " darktheme";
    ga('send', 'event', 'theme' , "darkcode");    
  }
  if (y == "dark") {
    document.body.className += " darkpagetheme";
    ga('send', 'event', 'theme' , "darkpage");
  }
})();
</script>





<script>
(
function setThemeCheckboxes() {
  var x = localStorage.getItem("preferredmode");
  var y = localStorage.getItem("preferredpagemode");  
  if (x == "dark") {
    document.getElementById("radio_darkcode").checked = true;
    
  }
  if (y == "dark") {
    document.getElementById("radio_darkpage").checked = true;
  }
})();

function mouseoverdarkicon() {
  if(window.matchMedia("(pointer: coarse)").matches) {
    return false;
  }
  var a = document.getElementById("darkmodemenu");
  a.style.top = "44px";
}
function mouseoutofdarkicon() {
  var a = document.getElementById("darkmodemenu");
  a.style.top = "-40px";
}
function changepagetheme(n) {
  var a = document.getElementById("radio_darkcode");
  var b = document.getElementById("radio_darkpage");
  document.body.className = document.body.className.replace("darktheme", "");
  document.body.className = document.body.className.replace("darkpagetheme", "");    
  document.body.className = document.body.className.replace("  ", " ");
  if (a.checked && b.checked) {
    localStorage.setItem("preferredmode", "light");
    localStorage.setItem("preferredpagemode", "light");
    a.checked = false;
    b.checked = false;    
  } else {
    document.body.className += " darktheme";
    document.body.className += " darkpagetheme";  
    localStorage.setItem("preferredmode", "dark");
    localStorage.setItem("preferredpagemode", "dark");
    a.checked = true;
    b.checked = true;    
  }
}


function click_darkpage() {
  var b = document.getElementById("radio_darkpage");
  if (b.checked) {
    document.body.className += " darkpagetheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "dark");
  } else {
    document.body.className = document.body.className.replace("darkpagetheme", "");
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredpagemode", "light");
  }
}

function click_darkcode() {
  var a = document.getElementById("radio_darkcode");
  if (a.checked) {
    document.body.className += " darktheme";
    document.body.className = document.body.className.replace("  ", " ");    
    localStorage.setItem("preferredmode", "dark");
  } else {
    document.body.className = document.body.className.replace("darktheme", "");
    document.body.className = document.body.className.replace("  ", " ");
    localStorage.setItem("preferredmode", "light");
  }
}

</script>

<div class="w3-main w3-light-grey" id="belowtopnav" style="margin-left:220px;">
<div class="w3-row w3-white">
<div class="w3-col l10 m12" id="main">

<h1>Machine Learning - Multiple Regression</h1>

<hr/>
<h2>Multiple Regression</h2>
<p>Multiple regression is like <a href="python_ml_linear_regression.asp">linear regression</a>, but with more than one 
independent value, meaning that we try to predict a value based on <strong>two 
or more</strong> variables.</p>
<p>Take a look at the data set below, it contains some information about cars.</p>
<div class="w3-border-bottom" style="margin-right:-20px;margin-left:-20px;">
<table class="ws-table-all co2cars" style="margin:0">
<thead>
<tr class="w3-light-grey">
<td>Car</td>
<td>Model</td>
<td>Volume</td>
<td>Weight</td>
<td>CO2</td>
<td style="width:10px"></td>
</tr>
</thead>
</table>
<div style="height:410px;overflow:auto;">
<table class="ws-table-all co2cars" style="margin:0;border-top:none;">
<tr>
<td>Toyota</td>
<td>Aygo</td>
<td>1000</td>
<td>790</td>
<td>99</td>
</tr>
<tr>
<td>Mitsubishi</td>
<td>Space Star</td>
<td>1200</td>
<td>1160</td>
<td>95</td>
</tr>
<tr>
<td>Skoda</td>
<td>Citigo</td>
<td>1000</td>
<td>929</td>
<td>95</td>
</tr>
<tr>
<td>Fiat</td>
<td>500</td>
<td>900</td>
<td>865</td>
<td>90</td>
</tr>
<tr>
<td>Mini</td>
<td>Cooper</td>
<td>1500</td>
<td>1140</td>
<td>105</td>
</tr>
<tr>
<td>VW</td>
<td>Up!</td>
<td>1000</td>
<td>929</td>
<td>105</td>
</tr>
<tr>
<td>Skoda</td>
<td>Fabia</td>
<td>1400</td>
<td>1109</td>
<td>90</td>
</tr>
<tr>
<td>Mercedes</td>
<td>A-Class</td>
<td>1500</td>
<td>1365</td>
<td>92</td>
</tr>
<tr>
<td>Ford</td>
<td>Fiesta</td>
<td>1500</td>
<td>1112</td>
<td>98</td>
</tr>
<tr>
<td>Audi</td>
<td>A1</td>
<td>1600</td>
<td>1150</td>
<td>99</td>
</tr>
<tr>
<td>Hyundai</td>
<td>I20</td>
<td>1100</td>
<td>980</td>
<td>99</td>
</tr>
<tr>
<td>Suzuki</td>
<td>Swift</td>
<td>1300</td>
<td>990</td>
<td>101</td>
</tr>
<tr>
<td>Ford</td>
<td>Fiesta</td>
<td>1000</td>
<td>1112</td>
<td>99</td>
</tr>
<tr>
<td>Honda</td>
<td>Civic</td>
<td>1600</td>
<td>1252</td>
<td>94</td>
</tr>
<tr>
<td>Hundai</td>
<td>I30</td>
<td>1600</td>
<td>1326</td>
<td>97</td>
</tr>
<tr>
<td>Opel</td>
<td>Astra</td>
<td>1600</td>
<td>1330</td>
<td>97</td>
</tr>
<tr>
<td>BMW</td>
<td>1</td>
<td>1600</td>
<td>1365</td>
<td>99</td>
</tr>
<tr>
<td>Mazda</td>
<td>3</td>
<td>2200</td>
<td>1280</td>
<td>104</td>
</tr>
<tr>
<td>Skoda</td>
<td>Rapid</td>
<td>1600</td>
<td>1119</td>
<td>104</td>
</tr>
<tr>
<td>Ford</td>
<td>Focus</td>
<td>2000</td>
<td>1328</td>
<td>105</td>
</tr>
<tr>
<td>Ford</td>
<td>Mondeo</td>
<td>1600</td>
<td>1584</td>
<td>94</td>
</tr>
<tr>
<td>Opel</td>
<td>Insignia</td>
<td>2000</td>
<td>1428</td>
<td>99</td>
</tr>
<tr>
<td>Mercedes</td>
<td>C-Class</td>
<td>2100</td>
<td>1365</td>
<td>99</td>
</tr>
<tr>
<td>Skoda</td>
<td>Octavia</td>
<td>1600</td>
<td>1415</td>
<td>99</td>
</tr>
<tr>
<td>Volvo</td>
<td>S60</td>
<td>2000</td>
<td>1415</td>
<td>99</td>
</tr>
<tr>
<td>Mercedes</td>
<td>CLA</td>
<td>1500</td>
<td>1465</td>
<td>102</td>
</tr>
<tr>
<td>Audi</td>
<td>A4</td>
<td>2000</td>
<td>1490</td>
<td>104</td>
</tr>
<tr>
<td>Audi</td>
<td>A6</td>
<td>2000</td>
<td>1725</td>
<td>114</td>
</tr>
<tr>
<td>Volvo</td>
<td>V70</td>
<td>1600</td>
<td>1523</td>
<td>109</td>
</tr>
<tr>
<td>BMW</td>
<td>5</td>
<td>2000</td>
<td>1705</td>
<td>114</td>
</tr>
<tr>
<td>Mercedes</td>
<td>E-Class</td>
<td>2100</td>
<td>1605</td>
<td>115</td>
</tr>
<tr>
<td>Volvo</td>
<td>XC70</td>
<td>2000</td>
<td>1746</td>
<td>117</td>
</tr>
<tr>
<td>Ford</td>
<td>B-Max</td>
<td>1600</td>
<td>1235</td>
<td>104</td>
</tr>
<tr>
<td>BMW</td>
<td>2</td>
<td>1600</td>
<td>1390</td>
<td>108</td>
</tr>
<tr>
<td>Opel</td>
<td>Zafira</td>
<td>1600</td>
<td>1405</td>
<td>109</td>
</tr>
<tr>
<td>Mercedes</td>
<td>SLK</td>
<td>2500</td>
<td>1395</td>
<td>120</td>
</tr>
</table>
</div>
</div>
<p>We can predict the CO2 emission of a car based on 
the size of the engine, but with multiple regression we can throw in more 
variables, like the weight of the car, to make the prediction more accurate.</p>
<hr/>
<h2>How Does it Work?</h2>
<p>In Python we have modules that will do the work for us. Start by importing 
the Pandas module.</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">import pandas</code></p>
</div>
<p>Learn about the Pandas module in our <a href="pandas_tutorial.asp">Pandas Tutorial</a>.</p>
<p>The Pandas module allows us to read csv files and return a DataFrame object.</p>
<p>The file is meant for testing purposes only, you can download it here: <a href="cars.csv">cars.csv</a></p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">df = pandas.read_csv("cars.csv")</code></p>
</div>
<p>Then make a list of the independent values and call this 
variable <code class="w3-codespan">X</code>. </p>
<p>Put the dependent values in a variable called <code class="w3-codespan">y</code>.</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">X = df[['Weight', 'Volume']]<br/>
y = df['CO2']</code></p>
</div>
<div class="w3-panel w3-note">
<p><strong>Tip:</strong>  It is common to name the list of independent values with a upper 
case X, and the list of dependent values with a lower case y.</p>
</div>
<p>We will use some methods from the sklearn module, so we will have to import that module as well:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">from sklearn import linear_model</code></p>
</div>
<p>From the sklearn module we will use the <code class="w3-codespan">LinearRegression()</code> method 
to create a linear regression object.</p>
<p>This object has a method called <code class="w3-codespan">fit()</code> that takes 
the independent and dependent values as parameters and fills the regression object with data that describes the relationship:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">regr = linear_model.LinearRegression()<br/>
regr.fit(X, y)</code></p>
</div>
<p>Now we have a regression object that are ready to predict CO2 values based on 
a car's weight and volume:</p>
<div class="w3-example w3-light-grey">
<p><code class="pythonHigh">#predict the CO2 emission of a car where the weight 
  is 2300kg, and the volume is 1300cm<sup>3</sup>:<br/>
  predictedCO2 = regr.predict([[2300, 1300]])</code></p>
</div>
<div class="w3-example">
<h3>Example</h3>
<p>See the whole example in action:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import linear_model<br/><br/>df = pandas.read_csv("cars.csv")<br/>
<br/>X = df[['Weight', 'Volume']]<br/>y = df['CO2']<br/><br/>regr = 
  linear_model.LinearRegression()<br/>regr.fit(X, y)<br/><br/>#predict the CO2 
  emission of a car where the weight is 2300kg, and the volume is 1300cm<sup>3</sup>:<br/>
  predictedCO2 = regr.predict([[2300, 1300]])<br/>
<br/>print(predictedCO2)</div>
<h3>Result:</h3>
<div class="w3-black w3-padding">
<pre>[107.2087328]</pre>
</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_multiple_regression" target="_blank">Run example »</a>
</p>
</div>
<p>We have predicted that a car with 1.3 liter engine, and a weight of 2300 kg, will release approximately 107 grams of CO2 for every 
kilometer it drives.</p>
<hr/>

<hr/>
<h2>Coefficient</h2>
<p>The coefficient is a factor that describes the relationship 
with an unknown variable.</p>
<p>Example: if <code class="w3-codespan">x</code> is a variable, then
<code class="w3-codespan">2x</code> is <code class="w3-codespan">x</code> two 
times. <code class="w3-codespan">x</code> is the unknown variable, and the 
number <code class="w3-codespan">2</code> is the coefficient.</p>
<p>In this case, we can ask for the coefficient value of weight against CO2, and 
for volume against CO2. The answer(s) we get tells us what would happen if we 
increase, or decrease, one of the independent values.</p>
<div class="w3-example">
<h3>Example</h3>
<p>Print the coefficient values of the regression object:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import linear_model<br/><br/>df = pandas.read_csv("cars.csv")<br/>
<br/>X = df[['Weight', 'Volume']]<br/>y = df['CO2']<br/><br/>regr = 
  linear_model.LinearRegression()<br/>regr.fit(X, y)<br/><br/>print(regr.coef_)</div>
<h3>Result:</h3>
<div class="w3-black w3-padding">
<pre>[0.00755095 0.00780526]</pre>
</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_coef" target="_blank">Run example »</a>
</p>
</div>
<h2>Result Explained</h2>
<p>The result array represents the coefficient values of weight and volume.</p>
<p>Weight: 0.00755095<br/>
Volume: 0.00780526</p>
<p>These values tell us that if the weight increase by 1kg, the CO2 
emission increases by 0.00755095g.</p>
<p>And if the engine size (Volume) increases by 1 cm<sup>3</sup>, the CO2 emission 
increases by 0.00780526 g.</p>
<p>I think that is a fair guess, but let test it!</p>
<p>We have already predicted that if a car with a 1300cm<sup>3</sup> engine weighs 2300kg, the CO2 emission will be approximately 107g.</p>
<p>What if we increase the weight with 1000kg?</p>
<div class="w3-example">
<h3>Example</h3>
<p>Copy the example from before, but change the weight from 2300 to 3300:</p>
<div class="w3-code notranslate pythonHigh">
  import pandas<br/>from sklearn import linear_model<br/><br/>df = pandas.read_csv("cars.csv")<br/>
<br/>X = df[['Weight', 'Volume']]<br/>y = df['CO2']<br/><br/>regr = 
  linear_model.LinearRegression()<br/>regr.fit(X, y)<br/><br/>predictedCO2 = regr.predict([[3300, 1300]])<br/>
<br/>print(predictedCO2)</div>
<h3>Result:</h3>
<div class="w3-black w3-padding">
<pre>[114.75968007]</pre>
</div>
<p>
<a class="w3-btn" href="showpython.asp?filename=demo_ml_coef2" target="_blank">Run example »</a>
</p>
</div>
<p>
We have predicted that a car with 1.3 liter engine, and a weight of 
3300 kg, will release approximately 115 grams of CO2 for every kilometer it drives.</p>
<p>
Which shows that the coefficient of 0.00755095 is correct:</p>
<p>
107.2087328 + (1000 * 0.00755095) = 114.75968</p>
<hr/>

<div id="mypagediv2" style="position:relative;text-align:center;"></div>
<br/>
</div>

</div>

</div>
<script src="/lib/w3schools_footer.js?update=20220202"></script>
<script>
  MyLearning.loadUser('footer');
  function docReady(fn) {
    document.addEventListener("DOMContentLoaded", fn);
    if (document.readyState === "interactive" || document.readyState === "complete" ) {
      fn();
    }
  }
  uic_r_z();
  uic_r_d()
</script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>  
<![endif]-->
</body>
</html>